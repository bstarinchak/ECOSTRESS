facet_wrap(~month_changes)+
theme_bw()+
theme(axis.text.x=element_text(size = rel(3)),
axis.text.y=element_text(size = rel(3)),
axis.title.x = element_text(size = rel(3)),
axis.title.y = element_text(size = rel(3)),
strip.text = element_text(size = rel(2)),
legend.position="none",
legend.key = element_rect(size=rel(1)),
legend.text = element_text(size = rel(1)),
legend.title = element_text(size=rel(1)),
plot.title = element_text(size = rel(2.5), face = "italic"),
strip.text.x=element_text(size = 20, margin = margin(10), vjust = 1))
load("Sac_profile_data")
load("Sac_woodStarch.Rda")
Sac_woodStarch_means_by_tree=Sac_woodStarch%>%group_by(ID, depth_mm, month, sampling_month)%>%
summarize(mean_starch_area=mean(X.Area, na.rm=T),
median_starch_are=median(X.Area, na.rm=T),
Int_quart_range=IQR(X.Area, na.rm=T),
sd_starch_area=sd(X.Area, na.rm=T),
sterr=var(X.Area, na.rm=T)/sqrt(length(X.Area)))
Sac_woodStarch_means_by_specie=Sac_woodStarch%>%group_by(depth_mm, month, sampling_month)%>%
summarize(mean_starch_area=mean(X.Area, na.rm=T),
median_starch_are=median(X.Area, na.rm=T),
Int_quart_range=IQR(X.Area, na.rm=T),
sd_starch_area=sd(X.Area, na.rm=T),
sterr=var(X.Area, na.rm=T)/sqrt(length(X.Area)))
Sac_woodStarch_means_by_tree$month=factor(Sac_woodStarch_means_by_tree$month,
levels = c("May19", "Aug19", "Nov19", "Feb20"))
Sac_woodStarch_means_by_specie$month=factor(Sac_woodStarch_means_by_specie$month,
levels = c("May19", "Aug19", "Nov19", "Feb20"))
ggplot()+
geom_line(data=filter(Sac_woodStarch_means_by_specie,month!="Jan18" && month !="Jul18") , aes(x=depth_mm, y=mean_starch_area, col=month), size=1)+
#facet_wrap(~month)+
#geom_line(data=filter(Sac_woodStarch_means_by_tree, month!="Jan18" && month !="Jul18"), aes(x=depth_mm, y=mean_starch_area, col=ID), col="gray95")+
geom_ribbon(data=filter(Sac_woodStarch_means_by_specie,month!="Jan18" && month !="Jul18"), aes(x=depth_mm,
ymin=abs(mean_starch_area-sd_starch_area),
ymax=mean_starch_area+sd_starch_area,
fill= month),
#fill="gray80",
alpha=0.1)+
ggtitle("S. guianensis\n(semi-deciduous/parenchyma-storing-species)")+
xlab("depth (mm)")+ylab("starch %")+
#xlim(0,110)+
theme_bw()+
theme(axis.text.x=element_text(size = rel(3)),
axis.text.y=element_text(size = rel(3)),
axis.title.x = element_text(size = rel(3)),
axis.title.y = element_text(size = rel(3)),
strip.text = element_text(size = rel(3)),
legend.position="none",
plot.title = element_text(size = rel(3), face = "italic"),
plot.margin = margin(10, 30, 10, 10,))
Sac_pairwise_comparison=Sac_woodStarch_means_by_tree
Sac_pairwise_comparison=Sac_pairwise_comparison[, c(1,2,3,5)]
Sac_pairwise_comparison$time=as.factor(Sac_pairwise_comparison$month)
Sac_pairwise_comparison=Sac_pairwise_comparison[order(Sac_pairwise_comparison$month),]
rownames(Sac_pairwise_comparison)=NULL
Sac_pairwise_comparison$ID=as.factor(Sac_pairwise_comparison$ID)
Sac_Anva2=Sac_pairwise_comparison%>%group_by(depth_mm)%>%nest()%>%
mutate(ANOVA=map(data, ~ aov(mean_starch_area~month, data=.x)),
tukey_comparison=map(ANOVA, TukeyHSD),
tidied=map(ANOVA, tidy),
tidied2=map(tukey_comparison, tidy),
)
names(Sac_Anva2$tidied)=Sac_Anva2$depth_mm
names(Sac_Anva2$tidied2)=Sac_Anva2$depth_mm
Sac_Anva2$tidied
Sac_Anva2$tidied2
estimates_ANOVA_by_depth=Sac_Anva2%>%unnest(tidied)
ggplot(Sac_woodStarch_means_by_tree, aes(x=month, y=mean_starch_area))+
geom_boxplot(data=Sac_woodStarch_means_by_tree, aes(x=month, y=mean_starch_area))+
geom_point(aes(col=ID))+
geom_point(data=Sac_woodStarch_means_by_specie, aes(x=month, y=mean_starch_area), col="black")+
facet_wrap(~depth_mm)
#wilcoxon comparison for mean starch area (starch concentrations) at different depth ranges in the wood cores
unique(Sac_pairwise_comparison$ID)
#wilcoxon comparison for mean starch area (starch concentrations) at different depth ranges in the wood cores
table(Sac_pairwise_comparison$ID)
#wilcoxon comparison for mean starch area (starch concentrations) at different depth ranges in the wood cores
table(unique(Sac_pairwise_comparison$ID))
#wilcoxon comparison for mean starch area (starch concentrations) at different depth ranges in the wood cores
table(unique(Sac_pairwise_comparison$month))
#wilcoxon comparison for mean starch area (starch concentrations) at different depth ranges in the wood cores
table(Sac_pairwise_comparison$month)
#sac_pairwise_comparison2=filter(sac_pairwise_comparison, ID!="sac34288") ## We had to remove this tree because we lost one month of measurements for this individuals and Wilcoxon  test requires identical sample size for each group.
sac_pairwise_comparison2$ID=factor(sac_pairwise_comparison2$ID)
sac_pairwise_comparison2$depth_mm2=as.factor(sac_pairwise_comparison2$depth_mm)
table(Sac_pairwise_comparison2$ID)
#sac_pairwise_comparison2=filter(sac_pairwise_comparison, ID!="sac34288") ## We had to remove this tree because we lost one month of measurements for this individuals and Wilcoxon  test requires identical sample size for each group.
Sac_pairwise_comparison2$ID=factor(Sac_pairwise_comparison2$ID)
Sac_pairwise_comparison2$depth_mm2=as.factor(Sac_pairwise_comparison2$depth_mm)
#sac_pairwise_comparison2=filter(sac_pairwise_comparison, ID!="sac34288") ## We had to remove this tree because we lost one month of measurements for this individuals and Wilcoxon  test requires identical sample size for each group.
Sac_pairwise_comparison2=Sac_woodStarch_means_by_tree
Sac_pairwise_comparison2$ID=factor(Sac_pairwise_comparison2$ID)
Sac_pairwise_comparison2$depth_mm2=as.factor(Sac_pairwise_comparison2$depth_mm)
table(Sac_pairwise_comparison2$ID)
str(sac_pairwise_comparison2)
sac_Anva3=sac_pairwise_comparison2%>%group_by(depth_mm2)%>%
wilcox_test(mean_starch_area~month, data=., paired = T)
sac_Anva3=Sac_pairwise_comparison2%>%group_by(depth_mm2)%>%
wilcox_test(mean_starch_area~month, data=., paired = T)
table(Sac_pairwise_comparison2$ID)
load("Ab_woodStarch.Rda")
Ab_woodStarch_means_by_tree=Ab_woodStarch%>%group_by(ID, depth_mm, month, sampling_month)%>%
summarize(mean_starch_area=mean(X.Area, na.rm=T),
median_starch_are=median(X.Area, na.rm=T),
Int_quart_range=IQR(X.Area, na.rm=T),
sd_starch_area=sd(X.Area, na.rm=T),
sterr=var(X.Area, na.rm=T)/sqrt(length(X.Area)))
Ab_woodStarch_means_by_specie=Ab_woodStarch%>%group_by(depth_mm, month, sampling_month)%>%
summarize(mean_starch_area=mean(X.Area, na.rm=T),
median_starch_are=median(X.Area, na.rm=T),
Int_quart_range=IQR(X.Area, na.rm=T),
sd_starch_area=sd(X.Area, na.rm=T),
sterr=var(X.Area, na.rm=T)/sqrt(length(X.Area)))
Ab_woodStarch_means_by_tree$month=factor(Ab_woodStarch_means_by_tree$month,
levels = c("May19", "Aug19", "Nov19", "Feb20"))
Ab_woodStarch_means_by_specie$month=factor(Ab_woodStarch_means_by_specie$month,
levels = c("May19", "Aug19", "Nov19", "Feb20"))
Ab_woodStarch_means_by_specie$month_season=Ab_woodStarch_means_by_specie$month
library(plyr)
months=unique(Ab_woodStarch_means_by_specie$month)
months_season=c("May 19 (transition)", "Aug 19 (Dry season)", "Nov 19 (transition)", "Feb 20 (wet season)")
Ab_woodStarch_means_by_specie$month_season=mapvalues(Ab_woodStarch_means_by_specie$month_season,
months,
months_season)
detach("package:plyr", unload=TRUE)
Ab_woodStarch_means_by_specie$month_season=factor(Ab_woodStarch_means_by_specie$month_season,
labels = c("May 19 (transition)",
"Aug 19 (Dry season)",
"Nov 19 (transition)",
"Feb 20 (wet season)"))
png("radial_starch_content_O-leu_scale_seasons_withlengend.png", width = 800, height = 600)
ggplot()+
geom_line(data=Ab_woodStarch_means_by_specie , aes(x=depth_mm, y=mean_starch_area, col=month_season), size=1)+
geom_ribbon(data=Ab_woodStarch_means_by_specie, aes(x=depth_mm,
ymin=mean_starch_area-sd_starch_area,
ymax=mean_starch_area+sd_starch_area,
fill= month_season),
#fill="gray80",
alpha=0.1)+
ggtitle("O. leucoxylon\n(evergreen/parenchyma-storing-species)")+
xlab("depth (mm)")+ylab("starch %")+
labs(color="Seasons", fill="Seasons")+
theme_bw()+
theme(axis.text.x=element_text(size = rel(3)),
axis.text.y=element_text(size = rel(3)),
axis.title.x = element_text(size = rel(2.5)),
axis.title.y = element_text(size = rel(2.5)),
strip.text = element_text(size = rel(3)),
legend.key.size = unit(1, "cm"),
legend.text = element_text(size = rel(3)),
legend.title = element_text(size = rel(3)),
#legend.position="none",
plot.title = element_text(size = rel(3), face = "italic"))
dev.off()
Ab_pairwise_comparison=Ab_woodStarch_means_by_tree
Ab_pairwise_comparison=Ab_pairwise_comparison[-c(1:24), c(1,2,3,5)]
Ab_pairwise_comparison$time=as.factor(Ab_pairwise_comparison$month)
Ab_pairwise_comparison=Ab_pairwise_comparison[order(Ab_pairwise_comparison$month),]
rownames(Ab_pairwise_comparison)=NULL
Ab_pairwise_comparison$ID=as.factor(Ab_pairwise_comparison$ID)
AB_Anva2=Ab_pairwise_comparison%>%group_by(depth_mm)%>%nest()%>%
mutate(ANOVA=map(data, ~ aov(mean_starch_area~month, data=.x)),
tukey_comparison=map(ANOVA, TukeyHSD),
tidied=map(ANOVA, tidy),
tidied2=map(tukey_comparison, tidy),
)
names(AB_Anva2$tidied)=AB_Anva2$depth_mm
names(AB_Anva2$tidied2)=AB_Anva2$depth_mm
AB_Anva2$tidied. # this shows the p_values of the comparisons between months at each depth
AB_Anva2$tidied2 # this is the posthoch Tikey comparison to see what months differed in starch concentration at each month
estimates_ANOVA_by_depth=AB_Anva2%>%unnest(tidied)
table(Ab_pairwise_comparison2$ID)
#wilcoxon comparison for mean starch area (starch concentrations) at different depth ranges in the wood cores
Ab_pairwise_comparison2=filter(Ab_pairwise_comparison, ID!="ab34288") ## We had to remove this tree because we lost one month of measurements for this individuals and Wilcoxon  test requires identical sample size for each group.
table(Ab_pairwise_comparison2$ID)
#sac_pairwise_comparison2=filter(sac_pairwise_comparison, ID!="sac34288") ## We had to remove this tree because we lost one month of measurements for this individuals and Wilcoxon  test requires identical sample size for each group.
Sac_pairwise_comparison2=Sac_woodStarch_means_by_tree
Sac_pairwise_comparison2$ID=factor(Sac_pairwise_comparison2$ID)
Sac_pairwise_comparison2$depth_mm2=as.factor(Sac_pairwise_comparison2$depth_mm)
table(Sac_pairwise_comparison2$ID)
#sac_pairwise_comparison2=filter(sac_pairwise_comparison, ID!="sac34288") ## We had to remove this tree because we lost one month of measurements for this individuals and Wilcoxon  test requires identical sample size for each group.
Sac_pairwise_comparison2=fiter(Sac_woodStarch_means_by_tree, ID!="Sac1054")
#sac_pairwise_comparison2=filter(sac_pairwise_comparison, ID!="sac34288") ## We had to remove this tree because we lost one month of measurements for this individuals and Wilcoxon  test requires identical sample size for each group.
Sac_pairwise_comparison2=filter(Sac_woodStarch_means_by_tree, ID!="Sac1054")
Sac_pairwise_comparison2$ID=factor(Sac_pairwise_comparison2$ID)
Sac_pairwise_comparison2$depth_mm2=as.factor(Sac_pairwise_comparison2$depth_mm)
table(Sac_pairwise_comparison2$ID)
str(sac_pairwise_comparison2)
sac_Anva3=Sac_pairwise_comparison2%>%group_by(depth_mm2)%>%
wilcox_test(mean_starch_area~month, data=., paired = T)
table(Sac_pairwise_comparison2$ID)
#sac_pairwise_comparison2=filter(sac_pairwise_comparison, ID!="sac34288") ## We had to remove this tree because we lost one month of measurements for this individuals and Wilcoxon  test requires identical sample size for each group.
Sac_pairwise_comparison2=filter(Sac_woodStarch_means_by_tree, ID!="Sac1054" & Id!="Sac27639")
#sac_pairwise_comparison2=filter(sac_pairwise_comparison, ID!="sac34288") ## We had to remove this tree because we lost one month of measurements for this individuals and Wilcoxon  test requires identical sample size for each group.
Sac_pairwise_comparison2=filter(Sac_woodStarch_means_by_tree, ID!="Sac1054" && Id!="Sac27639")
#sac_pairwise_comparison2=filter(sac_pairwise_comparison, ID!="sac34288") ## We had to remove this tree because we lost one month of measurements for this individuals and Wilcoxon  test requires identical sample size for each group.
Sac_pairwise_comparison2=filter(Sac_woodStarch_means_by_tree, ID!="Sac1054" && ID!="Sac27639")
Sac_pairwise_comparison2$ID=factor(Sac_pairwise_comparison2$ID)
Sac_pairwise_comparison2$depth_mm2=as.factor(Sac_pairwise_comparison2$depth_mm)
table(Sac_pairwise_comparison2$ID)
str(sac_pairwise_comparison2)
sac_Anva3=Sac_pairwise_comparison2%>%group_by(depth_mm2)%>%
wilcox_test(mean_starch_area~month, data=., paired = T)
table(Sac_pairwise_comparison2$ID)
#sac_pairwise_comparison2=filter(sac_pairwise_comparison, ID!="sac34288") ## We had to remove this tree because we lost one month of measurements for this individuals and Wilcoxon  test requires identical sample size for each group.
Sac_pairwise_comparison2=filter(Sac_woodStarch_means_by_tree, ID!="Sac1054" && ID!="Sac27638")
Sac_pairwise_comparison2$ID=factor(Sac_pairwise_comparison2$ID)
Sac_pairwise_comparison2$depth_mm2=as.factor(Sac_pairwise_comparison2$depth_mm)
table(Sac_pairwise_comparison2$ID)
str(sac_pairwise_comparison2)
sac_Anva3=Sac_pairwise_comparison2%>%group_by(depth_mm2)%>%
wilcox_test(mean_starch_area~month, data=., paired = T)
#sac_pairwise_comparison2=filter(sac_pairwise_comparison, ID!="sac34288") ## We had to remove this tree because we lost one month of measurements for this individuals and Wilcoxon  test requires identical sample size for each group.
Sac_pairwise_comparison2=filter(Sac_woodStarch_means_by_tree, ID!="Sac1054" && ID!="Sac27638", && ID!="Sac27640")
#sac_pairwise_comparison2=filter(sac_pairwise_comparison, ID!="sac34288") ## We had to remove this tree because we lost one month of measurements for this individuals and Wilcoxon  test requires identical sample size for each group.
Sac_pairwise_comparison2=filter(Sac_woodStarch_means_by_tree, ID!="Sac1054" && ID!="Sac27638" && ID!="Sac27640")
Sac_pairwise_comparison2$ID=factor(Sac_pairwise_comparison2$ID)
Sac_pairwise_comparison2$depth_mm2=as.factor(Sac_pairwise_comparison2$depth_mm)
table(Sac_pairwise_comparison2$ID)
str(sac_pairwise_comparison2)
str(Sac_pairwise_comparison2)
sac_Anva3=Sac_pairwise_comparison2%>%group_by(depth_mm2)%>%
wilcox_test(mean_starch_area~month, data=., paired = T)
table(Sac_pairwise_comparison2$ID)
names(Sac_profile_data_Jan18)
str(Sac_profile_data_Jan18)
names(Sac_profile_data_Aug_2019)
Sac_May19=Sac_profile_data_May_2019%>%select("ID", "depth_mm", "measurement_type", "X.Area", "sampling_month", "month")
Sac_Aug19=Sac_profile_data_Aug_2019%>%select("ID", "depth_mm", "measurement_type", "X.Area", "sampling_month", "month")
Sac_Aug19$month="Aug19"
Sac_Nov19=Sac_profile_data_Nov_2019%>%select("ID", "depth_mm", "measurement_type", "X.Area", "sampling_month", "month")
Sac_feb19=Sac_profile_data_Feb_2020%>%select("ID", "depth_mm", "measurement_type", "X.Area", "sampling_month", "month")
Sac=rbind(Sac_May19, Sac_Aug19, Sac_Nov19, Sac_feb19)
unique(Sac$ID)
Sac=Sac%>%separate(ID, c("ID", "radii_No"))
Sac$IDspecies=gsub("[[:digit:]]","",Sac$ID)
Sac$IDspecies="Sac"
Sac$IDnumber=gsub("[^[:digit:]]","", Sac$ID)
Sac$ID=paste(Sac$IDspecies, Sac$IDnumber, sep="")
Sac$ID[which(Sac$ID=="Sac34283")]="Sac34288"
Sac$ID[which(Sac$ID=="Sac27376")]="Sac25376"
Sac_woodStarch=filter(Sac, measurement_type=="woodStarch")
Sac_woodStarch$depth_mm=as.numeric(Sac_woodStarch$depth_mm)
Sac_woodStarch=Sac_woodStarch %>% group_by(ID, month) %>%
mapGroups(function(groups_ID){
max_depth_spp=max(Sac_woodStarch$depth_mm)
max_depth_grou=max(groups_ID$depth_mm)
while(max_depth_grou<max_depth_spp){
i=length(groups_ID$depth_mm)
groups_ID[c(i+1, i+2, i+3), "depth_mm"]=max(groups_ID$depth_mm)+5
groups_ID$ID[c(i+1, i+2, i+3)]=groups_ID$ID[1]
groups_ID$measurement_type="woodStarch"
groups_ID$month=groups_ID$month[1]
groups_ID$sampling_month[c(i+1, i+2, i+3)]=groups_ID$sampling_month[1]
max_depth_grou=max(groups_ID$depth_mm)
}
groups_ID$X.Area[is.na(groups_ID$X.Area)]=0
return(groups_ID)
}
) %>% ungroup()
save(Sac_woodStarch, file = "Sac_woodStarch.Rda")
save(Sac_woodStarch, file = "Sac_woodStarch.csv")
getwd()
load("Sac_woodStarch.Rda")
Sac_woodStarch_means_by_tree=Sac_woodStarch%>%group_by(ID, depth_mm, month, sampling_month)%>%
summarize(mean_starch_area=mean(X.Area, na.rm=T),
median_starch_are=median(X.Area, na.rm=T),
Int_quart_range=IQR(X.Area, na.rm=T),
sd_starch_area=sd(X.Area, na.rm=T),
sterr=var(X.Area, na.rm=T)/sqrt(length(X.Area)))
Sac_woodStarch_means_by_specie=Sac_woodStarch%>%group_by(depth_mm, month, sampling_month)%>%
summarize(mean_starch_area=mean(X.Area, na.rm=T),
median_starch_are=median(X.Area, na.rm=T),
Int_quart_range=IQR(X.Area, na.rm=T),
sd_starch_area=sd(X.Area, na.rm=T),
sterr=var(X.Area, na.rm=T)/sqrt(length(X.Area)))
Sac_woodStarch_means_by_tree$month=factor(Sac_woodStarch_means_by_tree$month,
levels = c("May19", "Aug19", "Nov19", "Feb20"))
Sac_woodStarch_means_by_specie$month=factor(Sac_woodStarch_means_by_specie$month,
levels = c("May19", "Aug19", "Nov19", "Feb20"))
ggplot()+
geom_line(data=filter(Sac_woodStarch_means_by_specie,month!="Jan18" && month !="Jul18") , aes(x=depth_mm, y=mean_starch_area, col=month), size=1)+
#facet_wrap(~month)+
#geom_line(data=filter(Sac_woodStarch_means_by_tree, month!="Jan18" && month !="Jul18"), aes(x=depth_mm, y=mean_starch_area, col=ID), col="gray95")+
geom_ribbon(data=filter(Sac_woodStarch_means_by_specie,month!="Jan18" && month !="Jul18"), aes(x=depth_mm,
ymin=abs(mean_starch_area-sd_starch_area),
ymax=mean_starch_area+sd_starch_area,
fill= month),
#fill="gray80",
alpha=0.1)+
ggtitle("S. guianensis\n(semi-deciduous/parenchyma-storing-species)")+
xlab("depth (mm)")+ylab("starch %")+
#xlim(0,110)+
theme_bw()+
theme(axis.text.x=element_text(size = rel(3)),
axis.text.y=element_text(size = rel(3)),
axis.title.x = element_text(size = rel(3)),
axis.title.y = element_text(size = rel(3)),
strip.text = element_text(size = rel(3)),
legend.position="none",
plot.title = element_text(size = rel(3), face = "italic"),
plot.margin = margin(10, 30, 10, 10,))
Sac_pairwise_comparison=Sac_woodStarch_means_by_tree
Sac_pairwise_comparison=Sac_pairwise_comparison[, c(1,2,3,5)]
Sac_pairwise_comparison$time=as.factor(Sac_pairwise_comparison$month)
Sac_pairwise_comparison=Sac_pairwise_comparison[order(Sac_pairwise_comparison$month),]
rownames(Sac_pairwise_comparison)=NULL
Sac_pairwise_comparison$ID=as.factor(Sac_pairwise_comparison$ID)
Sac_Anva2=Sac_pairwise_comparison%>%group_by(depth_mm)%>%nest()%>%
mutate(ANOVA=map(data, ~ aov(mean_starch_area~month, data=.x)),
tukey_comparison=map(ANOVA, TukeyHSD),
tidied=map(ANOVA, tidy),
tidied2=map(tukey_comparison, tidy),
)
names(Sac_Anva2$tidied)=Sac_Anva2$depth_mm
names(Sac_Anva2$tidied2)=Sac_Anva2$depth_mm
Sac_Anva2$tidied
Sac_Anva2$tidied2
estimates_ANOVA_by_depth=Sac_Anva2%>%unnest(tidied)
estimates_ANOVA_by_depth
table(Sac_pairwise_comparison$ID)
max(Sac_woodStarch$depth_mm)
24*4
### generate the cero values for the inner layesr of wood that were not measured because the Sacsence of starch
table(Sac_woodStarch$ID)
Sac_woodStarch=Sac_woodStarch %>% group_by(ID, month) %>%
mapGroups(function(groups_ID){
max_depth_spp=max(Sac_woodStarch$depth_mm)
max_depth_grou=max(groups_ID$depth_mm)
while(max_depth_grou<max_depth_spp){
i=length(groups_ID$depth_mm)
groups_ID[c(i+1, i+2, i+3), "depth_mm"]=max(groups_ID$depth_mm)+5
groups_ID$ID[c(i+1, i+2, i+3)]=groups_ID$ID[1]
groups_ID$measurement_type="woodStarch"
groups_ID$month=groups_ID$month[1]
groups_ID$sampling_month[c(i+1, i+2, i+3)]=groups_ID$sampling_month[1]
max_depth_grou=max(groups_ID$depth_mm)
}
groups_ID$X.Area[is.na(groups_ID$X.Area)]=0
return(groups_ID)
}
) %>% ungroup()
table(Sac_woodStarch$ID)
table(Sac_woodStarch_means_by_tree)
table(Sac_woodStarch_means_by_tree$ID)
Sac_woodStarch_means_by_tree=Sac_woodStarch%>%group_by(ID, depth_mm, month)%>%
summarize(mean_starch_area=mean(X.Area, na.rm=T),
median_starch_are=median(X.Area, na.rm=T),
Int_quart_range=IQR(X.Area, na.rm=T),
sd_starch_area=sd(X.Area, na.rm=T),
sterr=var(X.Area, na.rm=T)/sqrt(length(X.Area)))
table(Sac_woodStarch_means_by_tree$ID)
View(Ab_pairwise_comparison2)
View(Sac_pairwise_comparison2)
table(Sac_pairwise_comparison$ID, Sac_pairwise_comparison2$depth_mm2)
table(Sac_pairwise_comparison$ID, Sac_pairwise_comparison2$depth_mm2)
table(Sac_pairwise_comparison$ID*Sac_pairwise_comparison2$depth_mm2)
with(Sac_pairwise_comparison2, table(ID, depth_mm2)
with(Sac_pairwise_comparison2, table(ID, depth_mm2))
with(Sac_pairwise_comparison2, table(ID, depth_mm2))
ggplot(Sac_woodStarch_means_by_tree, aes(x=month, y=mean_starch_area))+
geom_boxplot(data=Sac_woodStarch_means_by_tree, aes(x=month, y=mean_starch_area))+
geom_point(aes(col=ID))+
geom_point(data=Sac_woodStarch_means_by_specie, aes(x=month, y=mean_starch_area), col="black")+
facet_wrap(~depth_mm)
Sac_woodStarch_radial_activity=Sac_woodStarch_means_by_tree%>%group_by(ID, depth_mm)%>%
summarise(activ_mean=max(mean_starch_area)-min(mean_starch_area),
rel_activ_mean=(max(mean_starch_area)-min(mean_starch_area))/max(mean_starch_area)*100,
activ_median=max(median_starch_are)-min(median_starch_are),
activ_IQR=max(Int_quart_range)-min(Int_quart_range),
max_starch=max(mean_starch_area),
max_month=.data$month[max(which(.data$mean_starch_area==max(.data$mean_starch_area)))],
min_starch=min(mean_starch_area),
min_month=.data$month[min(which(.data$mean_starch_area==min(.data$mean_starch_area)))]
)
Sac_woodStarch_radial_activity=na.omit(Sac_woodStarch_radial_activity)
Sac_woodStarch_radial_Activity_by_species=Sac_woodStarch_radial_activity%>%group_by(depth_mm)%>%
summarise(mean_active_mean=mean(activ_mean, na.rm=T),
rel_mean_active_mean=mean(rel_activ_mean, na.rm=T),
SD_rel_mean_active_mean=sd(rel_activ_mean, na.rm=T),
mean_active_median=mean(activ_median),
mean_active_IQR=mean(activ_IQR),
SD_active_mean=sd(activ_mean),
SD_active_median=sd(activ_median),
Sd_active_IQR=sd(activ_IQR),
max=max(max_starch),
mean_max=mean(max_starch),
max_month_mode=names(which.max(table(max_month))),
min=min(min_starch),
mean_min=mean(min_starch),
min_month_mode=names(which.max(table(min_month)))
)
ggplot(data=Sac_woodStarch_radial_Activity_by_species, aes(x=depth_mm, y=mean_active_mean))+
geom_line(data=Sac_woodStarch_radial_activity, aes(x=depth_mm, y=activ_mean, factor=ID), col="gray95")+
geom_line( col="turquoise3")+
geom_ribbon( aes(ymin=mean_active_mean-SD_active_mean, ymax=mean_active_mean+SD_active_mean,
fill= "var"),
fill="turquoise3",
alpha=0.3)+
ggtitle("S. guianensis\n(semi-deciduous/parenchyma-storing-species)")+
xlab("depth (mm)")+ylab("seasonal amplitud starch %")+
theme_bw()+
theme(axis.text.x=element_text(size = rel(4)),
axis.text.y=element_text(size = rel(4)),
axis.title.x = element_text(size = rel(4)),
axis.title.y = element_text(size = rel(4)),
strip.text = element_text(size = rel(4)),
legend.position="none",
plot.title = element_text(size = rel(3), face = "italic"),
plot.margin = margin(10, 30, 10, 10,))
# check outliers
Sac_woodStarch_radial_activity%>%group_by(depth_mm)%>%identify_outliers(activ_mean)
#normality assumption
Sac_woodStarch_radial_activity%>%group_by(depth_mm)%>%shapiro_test(activ_mean)
ggqqplot(Sac_woodStarch_radial_activity, "activ_mean", facet.by = "depth_mm")
Sac_woodStarch_radial_activity
#normality assumption
Sac_woodStarch_radial_activity%>%filter(depth_mm<115)%>%group_by(depth_mm)%>%shapiro_test(activ_mean)
str(Sac_woodStarch_radial_activity)
seasonal_amplitud_anova=aov(activ_mean~as.factor(depth_mm), data=Sac_woodStarch_radial_activity)
summary(seasonal_amplitud_anova)
ggplot(data=Sac_woodStarch_radial_Activity_by_species, aes(x=depth_mm, y=mean_active_mean))+
geom_line(data=Sac_woodStarch_radial_activity, aes(x=depth_mm, y=activ_mean, factor=ID), col="gray95")+
geom_line( col="turquoise3")+
geom_ribbon( aes(ymin=mean_active_mean-SD_active_mean, ymax=mean_active_mean+SD_active_mean,
fill= "var"),
fill="turquoise3",
alpha=0.3)+
ggtitle("S. guianensis\n(semi-deciduous/parenchyma-storing-species)")+
xlab("depth (mm)")+ylab("seasonal amplitud starch %")+
theme_bw()+
theme(axis.text.x=element_text(size = rel(4)),
axis.text.y=element_text(size = rel(4)),
axis.title.x = element_text(size = rel(4)),
axis.title.y = element_text(size = rel(4)),
strip.text = element_text(size = rel(4)),
legend.position="none",
plot.title = element_text(size = rel(3), face = "italic"),
plot.margin = margin(10, 30, 10, 10,))
ggplot(data=Sac_woodStarch_radial_Activity_by_species, aes(x=depth_mm, y=rel_mean_active_mean))+
geom_line(data=Sac_woodStarch_radial_activity, aes(x=depth_mm, y=rel_activ_mean, factor=ID), col="gray95")+
geom_line( col="turquoise3")+
geom_ribbon( aes(ymin=rel_mean_active_mean-SD_rel_mean_active_mean, ymax=rel_mean_active_mean+SD_rel_mean_active_mean,
fill= "var"),
fill="turquoise3",
alpha=0.3)+
ggtitle("S. guianensis\n(semi-deciduous/parenchyma-storing-species)")+
xlab("depth (mm)")+ylab("relative seasonal amplitud")+
theme_bw()+
theme(axis.text.x=element_text(size = rel(4)),
axis.text.y=element_text(size = rel(4)),
axis.title.x = element_text(size = rel(4)),
axis.title.y = element_text(size = rel(4)),
strip.text = element_text(size = rel(4)),
legend.position="none",
plot.title = element_text(size = rel(3), face = "italic"),
plot.margin = margin(10, 30, 10, 10,))
Sac_woodStarch_means_by_tree$segment_volume_cm3=pi*(0.5/2)^2*0.5 ### this in in cm3
Sac_woodStarch_means_by_tree$grams_wood=Sac_woodStarch_means_by_tree$segment_volume_cm3*0.8
Sac_woodStarch_means_by_tree$grams_starch=Sac_woodStarch_means_by_tree$grams_wood*Sac_woodStarch_means_by_tree$mean_starch_area/100
Sac_woodStarch_means_by_tree$mg_starch=Sac_woodStarch_means_by_tree$grams_starch*1000
Sac_woodStarch_means_entire_tree=Sac_woodStarch_means_by_tree%>%group_by(month, ID)%>%
summarise(mean_starch_percentage=mean(mean_starch_area),
median_starch_percentage=mean(median_starch_are),
mean_IQR=mean(Int_quart_range),
starch_woodcore_content_by_mean=sum(mean_starch_area),
starch_woodcore_content_by_median=sum(median_starch_are),
starch_woodcore_content_grams=sum(grams_starch),
starch_woodcore_content_mg=sum(mg_starch))
Sac_woodStarch_means_entire_tree=Sac_woodStarch_means_by_tree%>%group_by(month, ID)%>%
summarise(mean_starch_percentage=mean(mean_starch_area),
median_starch_percentage=median(median_starch_are),
mean_IQR=mean(Int_quart_range),
starch_woodcore_content_by_mean=sum(mean_starch_area),
starch_woodcore_content_by_median=sum(median_starch_are),
starch_woodcore_content_grams=sum(grams_starch))
Sac_woodStarch_means_entire_tree$starch_woodcore_content_mg=Sac_woodStarch_means_entire_tree$starch_woodcore_content_grams*1000
Sac_woodStarch_means_entire_tree_by_specie=Sac_woodStarch_means_entire_tree%>%group_by(month)%>%
summarise(mean_starch_percentage=mean(mean_starch_percentage),
sd_mean_starch_percentage=sd(mean_starch_percentage),
median_starch_percentage=mean(median_starch_percentage),
sd_median_starch_percentage=sd(median_starch_percentage),
mean_IQR=mean(mean_IQR),
mean_starch_wood_content_by_mean=mean(starch_woodcore_content_by_mean),
sd_starch_wood_content_by_mean=sd(starch_woodcore_content_by_mean),
mean_starch_wood_content_by_median=mean(starch_woodcore_content_by_median),
sd_starch_wood_content_by_medial=sd(starch_woodcore_content_by_median),
mean_starch_wood_content_grams=mean(starch_woodcore_content_grams),
sd_mean_starch_wood_content_grams=sd(starch_woodcore_content_grams),
mean_starch_wood_content_mg=mean(starch_woodcore_content_mg)
)
Sac_woodStarch_means_entire_tree$starch_woodcore_content_mg=Sac_woodStarch_means_entire_tree$starch_woodcore_content_grams*1000
ggplot(Sac_woodStarch_means_entire_tree, aes(x=month, y=starch_woodcore_content_mg))+geom_boxplot(fill="turquoise2")+
geom_point(aes(col=ID))+
geom_point(data=Sac_woodStarch_means_entire_tree_by_specie, aes(x=month, y=mean_starch_wood_content_mg),  col="black", pch=17, size=3)+
xlab("")+
ylab("Starch woodcore content (mg)")+
ggtitle("S. guianensis\n(semi-deciduous/parenchyma-storing-species)")+
theme_bw()+
theme(axis.text.x=element_text(size = rel(3)),
axis.text.y=element_text(size = rel(3)),
axis.title.x = element_text(size = rel(3)),
axis.title.y = element_text(size = rel(3)),
strip.text = element_text(size = rel(1.5)),
legend.position="none",
legend.key = element_rect(size=rel(1)),
legend.text = element_text(size = rel(1)),
legend.title = element_text(size=rel(1)),#legend.position="none",
plot.title = element_text(size = rel(3), face = "italic"))
